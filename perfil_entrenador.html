<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
  <meta name="description" content="">
  <meta name="author" content="">
  <link rel="icon" href="images/ic_launcher.png">
  <title>Registro de Entrenadores</title>

  <script src="https://www.gstatic.com/firebasejs/3.4.1/firebase.js"></script>
  <script>
    // Initialize Firebase
    var config = {
    apiKey: "AIzaSyB4JmaNIheFUZwMsjTBXCnFHKQNfpRFfXA",
    authDomain: "formularios-81a40.firebaseapp.com",
    databaseURL: "https://formularios-81a40.firebaseio.com",
    storageBucket: "formularios-81a40.appspot.com",
    messagingSenderId: "793947826055"
    };
    firebase.initializeApp(config);
  </script>
  <link href="dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="dist/css/navbar-fixed-top.css" rel="stylesheet">
  <link href="dist/css/signin.css" rel="stylesheet">
  <link href="dist/css/custom.css" rel="stylesheet">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/timepicker/1.3.5/jquery.timepicker.min.css">

  <!-- Bootstrap core JavaScript
  ================================================== -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="assets/js/vendor/jquery.min.js"><\/script>')</script>
  <script src="dist/js/bootstrap.min.js"></script>
  <script src="assets/js/docs.min.js"></script>

  <script src="//cdnjs.cloudflare.com/ajax/libs/timepicker/1.3.5/jquery.timepicker.min.js"></script>
</head>

<body>
  <!-- Fixed navbar -->
  <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a href="index.html">
            <img class="navbar-brand" alt="Brand" src="images/ic_launcher.png">
          </a>
        </div>
          <div id="navbar" class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
              <li class="active">
                <a href="#">Bienvenid@, usuario
                </a>
              </li>
              <li><a href="#">Panel de Control</a></li>
              </li>
              <li>
                <a href="#">Páginas Personales</a>
              </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
              <li class="active"><a id="cerrarSesion" href="#">Cerrar Sesion<span class="sr-only">(current)</span></a></li>
            </ul>
          </div>
      </div>
    </div>
  <br>
  <div class="container">
    <div class="row">
      <div class="col-xs-4 col-md-4"> 
        <div id="imagenEntrenador"></div>
      </div>
      <div class="col-xs-0 col-md-1"> 
      </div>
      <div class="col-xs-8 col-md-7">
        <div class="panel panel-default">
          <div class="panel-heading">
            <label><h4><b> Información del entrenador </b></h4></label> 
          </div>
          <div class="panel-body">
            <h4>
              <label> Nombre: </label> 
              <h4 id="nombreEntrenador">  </h4>
            </h4>
          </div>
          <div class="panel-body">
            <h4>
              <label> Biografía: </label>
              <div class="campo">
                <h4 id="biografiaEntrenador">  </h4>
              </div>
            </h4>
          </div>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-xs-12 col-md-12"> 
        <center> PROSPECTO </center>
      </div>
    </div>
    <div class="row">
      <div class="col-xs-6 col-md-5"> 
        <div class="panel panel-default">
          <div class="panel-heading">
            <label><h4><b> Videos </b></h4></label> 
          </div>
          <div class="panel-body">
            <h4>
              <label> Lunes: </label> 
              <a href="https://livestream.com/accounts/20125261/events/6251835"> Reunión de oportunidad </a>
            </h4>
          </div>
          <div class="panel-body">
            <h4>
              <label> Jueves: </label>
              <a href="https://livestream.com/accounts/20125261/events/6307112"> Seminario de nutrición </a>
            </h4>
          </div>
        </div>
      </div>
      <div class="col-xs-0 col-md-2"> 
      </div>
      <div class="col-xs-6 col-md-5">
        <div class="panel panel-default">
          <div class="panel-heading">
            <label><h4><b> Horarios Reuniones </b></h4></label> 
          </div>
          <div class="panel-body">
            <h4>
              <label> Lunes: </label> 
              22:00
            </h4>
          </div>
          <div class="panel-body">
            <h4>
              <label> Jueves: </label>
              22:00
            </h4>
          </div>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-xs-12 col-md-12">
        <h5 id="codigoEntrenador"> </h5>
      </div> 
    </div>
  </div>
  <footer class ="bs-docs-footer textcolorWhite" role="contentinfo">
    <p>
      <h3>Siguenos en</h3>
    </p>
    <p>
      <a href="#facebook"><img src="images/social/facebook.png" width="60px" height="60px"></img></a>
      <a href="#youtube"><img src="images/social/youtube.png" width="60px" height="60px"></img></a>
      <a href="#instagram"><img src="images/social/instagram.png" width="60px" height="60px"></img></a>
    </p>
    <p>&copy; 2016 Nivel 10. All rights reserved.
      <a href="#privacy">Privacy</a><font color=white size="3">.</font>
      <a href="#terms">Terms of Service</a>.
    </p>
  </footer>
  <script type="text/javascript">
    var iniciado = false;
    if(!iniciado){
      init();
      iniciado = true;
    }
    function getParameterByName(name, url) {
      if (!url) url = window.location.href;
      name = name.replace(/[\[\]]/g, "\\$&");
      var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
          results = regex.exec(url);
      if (!results) return null;
      if (!results[2]) return '';
      return decodeURIComponent(results[2].replace(/\+/g, " "));
    }

    /** Inicializar la app **/
    function init(){
      /** Datos **/
      var userId = getParameterByName("id")
      var entrenadores = firebase.database().ref('entrenador/'+userId+'/perfil/');
      entrenadores.on('value', function(data) {
        //console.log(data.val());
        setImage(data.val().url_imagen);
        setInfo(data.val(), userId);
      });
    }

    /** Imagen **/
    function setImage(urlImagen){
      /** Imagen **/
      var storage = firebase.storage();
      var pathReference = storage.ref(urlImagen);
      pathReference.getDownloadURL().then(function(url) {
        // Insert url into an <img> tag to "download"
        //console.log(url);

        var divImg = document.getElementById('imagenEntrenador');
        var img = document.createElement('img');
        img.setAttribute("src", url);
        divImg.appendChild(img);
      }).catch(function(error) {
        switch (error.code) {
          case 'storage/object_not_found':
            // File doesn't exist
            break;

          case 'storage/unauthorized':
            // User doesn't have permission to access the object
            break;

          case 'storage/canceled':
            // User canceled the upload
            break;
          case 'storage/unknown':
            // Unknown error occurred, inspect the server response
            break;
        }
      });
    }

    /** Información básica del entrenador **/
    function setInfo(data, key){
      //console.log(data);
      var divNombre = document.getElementById('nombreEntrenador');
      var divBiografia = document.getElementById('biografiaEntrenador');
      var codigo = document.getElementById('codigoEntrenador');

      divNombre.innerHTML = data.nombre;
      divBiografia.innerHTML = data.biografia;
      codigo.innerHTML = "Ingresa el código <b>"+key+"</b>";
    }
    /** Cerrar Sesión **/
    var cerrar = document.getElementById('cerrarSesion');
    cerrar.addEventListener('click', function () {
      localStorage.removeItem("nombre");
      localStorage.removeItem("userID");
      window.location.assign("index.html");
    });
  </script>
</body>
</html>